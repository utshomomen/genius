flexbe_cli.block.register("ACADEMY_FEED",{lastItem:0,loading:!1,list:[],onScreen:function(t){t&&this.initFit()},initFit:function(){var t=this;this.fitInited=!0,this.$loader=this.$area.find(".updates-loader");var a=-1,i=flexbe_cli.resize.height,e=!1;requestAnimationFrame(function s(){if(requestAnimationFrame(s),t.tween&&t.tween.onscreen&&(!t.fitInited||a!==flexbe_cli.scroll.latest)){a=flexbe_cli.scroll.latest,i=flexbe_cli.resize.height,e=t.loaderState;var l=(t.$loader.offset()||{}).top;t.loaderState=a+i>=l,e!==t.loaderState&&t.loaderState&&t.loadFit()}})},loadFit:function(t){var a=this;if(void 0===t&&(t=function(){}),!this.loading){this.loading=!0;var i=[];$.ajax({url:"/admin/updates/get_updates",type:"POST",dataType:"json",data:{limit:5,last_id:this.lastItem}}).done(function(e){if(e.is_success&&e.data){var s="",l=-1;e.data.forEach(function(t){var e=a.list.findIndex(function(a){return a.id==t.id});if(e>=0)l=e,a.list.splice(e,1,t);else{var s=-1===l?a.list.length:l;a.list.splice(s,0,t),i.splice(s,0,t)}}),i.forEach(function(t){s+='<div class="card-item"><div class="date-wrap"><span data-info="data" class="date">',s+=t.date,s+='</span></div><div class="line-wrap"><span class="line line-top"></span><span class="dot"></span><span class="line line-bottom"></span></div><div class="card-wrapper"><div class="img-card">',s+='<img  data-info="img"  src="'+t.image+'" srcset="'+t.image_retina+' 2x">',s+='</div><div class="info"><span  data-info="data"  class="mobile-date">'+t.date+"</span>",s+='<div  data-info="title"  class="title">'+t.title+"</div>",s+='<div  data-info="text"  class="text">'+t.text+"</div>",t.buttons.length&&(s+='<div class="wrap-button">',t.buttons.forEach(function(t){s+='<a href="'+t.url+'"',s+=t.new_window?' target="_blank"':"",s+=' class="gubert-button blue fill select size-l">'+t.title+"</a>"}),s+="</div>"),s+="</div></div></div>"}),a.list.length&&a.$area.find(".updates-loader-wrap").removeClass("zero"),i.length&&a.$area.find(".cards-container").append(s),i.length<5&&(a.$area.find(".updates-loader-wrap").removeClass("active"),a.$area.find(".card-item:last-of-type .line.line-bottom").css("width","0")),a.loading=!1,a.lastItem=a.list[a.list.length-1].id}else t(new Error(e.message))}).fail(function(i){t(new Error(i)),a.loading=!1})}}});
flexbe_cli.block.register("CARD",{onUpdate:function(e){var i=this;void 0===e&&(e={}),setTimeout(function(){var r=flexbe_cli.components.instances[i.id].find(function(e){return"cards"===e.is}),s=r&&r.swiper;if(!s)return!1;if(e.templateRendered&&e&&"items_add"===e.reason){var n=s.realIndex,t=e.reasonData.to,a=n;n+s.params.slidesPerView<=t&&(a=t-s.params.slidesPerView+1),a!==n&&s.slideTo(a)}e.styleRendered&&s.update(!1)},100)}});
flexbe_cli.block.register("GALLERY",{onUpdate:function(e){var i=this;void 0===e&&(e={}),setTimeout(function(){var r=flexbe_cli.components.instances[i.id].find(function(e){return"cards"===e.is}),s=r&&r.swiper;if(!s)return!1;if(e.templateRendered&&e&&"items_add"===e.reason){var n=s.realIndex,t=e.reasonData.to,a=n;n+s.params.slidesPerView<=t&&(a=t-s.params.slidesPerView+1),a!==n&&s.slideTo(a)}e.styleRendered&&s.update(!1)},100)}});
flexbe_cli.block.register("LOGO",{onUpdate:function(e){var i=this;void 0===e&&(e={}),setTimeout(function(){var r=flexbe_cli.components.instances[i.id].find(function(e){return"cards"===e.is}),s=r&&r.swiper;if(!s)return!1;if(e.templateRendered&&e&&"items_add"===e.reason){var n=s.realIndex,t=e.reasonData.to,a=n;n+s.params.slidesPerView<=t&&(a=t-s.params.slidesPerView+1),a!==n&&s.slideTo(a)}e.styleRendered&&s.update(!1)},100)}});
flexbe_cli.element.register("map01",{onScreen:function(e){var i=this;setInterval(this.resizeTmt),flexbe_cli.is_admin&&e&&(this.resizeTmt=setInterval(function(){var e=i.$area.outerHeight();i.oldHH!==e&&(i.oldHH&&i._onResize({is:i.is,id:i.id,reason:"client_resize"}),i.oldHH=e)},200))}});
flexbe_cli.element.register("media02",{onLoad:function(){this.$container=this.$area.find(".state-container"),this.$before=this.$container.find(".state-before"),this.$after=this.$container.find(".state-after"),this.$beforeImage=this.$before.find(".component-image"),this.$afterImage=this.$after.find(".component-image"),this.$handle=this.$container.find(".drag-handle"),this.direction=this.$container.attr("data-direction"),this.initial=this.$container.attr("data-initial")||50,this.clientInited||(this.clientInited=!0,this.position=this.initial,this.$container.addClass("inited")),this.bindEvents(),this.setSize(),this.setClip(this.initial)},onResize:function(){this.setSize(),this.setClip(this.position)},bindEvents:function(){function t(t){if(!flexbe_cli.scroll.inScroll&&(!flexbe_cli.is_admin||t.target.closest(".drag-handle"))){var v=f.closest(".swiper-inited")[0];v&&v.swiper&&!h&&(r=v.swiper,h=!0,r.detachEvents()),u=!0,a=l.getBoundingClientRect();var m=t.touches&&t.touches[0]||t;o=s(m,a),f.addClass("drag"),flexbe_cli.is_admin||d.setClip(o),document.body.addEventListener("mousemove",e),document.body.addEventListener("touchmove",e,{passive:!1},!1),window.addEventListener("mouseup",i),window.addEventListener("touchend",i,{passive:!1},!1),"y"===c&&n(t)}}function e(t){if(u){var e=s(t.touches&&t.touches[0]||t,a),i=Math.abs(o-e);if(!v){if(i<.8)return;v=!0,f.addClass("resize")}d.setClip(e),"y"===c&&n(t)}}function i(){u=!1,v=!1,f.removeClass("drag resize"),document.removeEventListener("mousemove",e),document.removeEventListener("touchmove",e),document.removeEventListener("mouseup",i),document.removeEventListener("touchend",i),r&&h&&(h=!1,r.attachEvents())}function n(t){t.preventDefault(),t.stopPropagation()}function s(t,e){return 100*("y"===c?(t.clientY-e.top)/e.height:(t.clientX-e.left)/e.width)}var o,a,r,h,d=this,c=this.direction,f=this.$container,l=f[0],u=!1,v=!1;this.$area[0].addEventListener("pointerdown",function(t){t.stopPropagation()},!1),l.addEventListener("mousedown",t,{passive:!1},!1),l.addEventListener("touchstart",t,{passive:!1},!1)},setSize:function(){var t=this.direction,e=this.$container["y"===t?"innerHeight":"innerWidth"]();return e=Math.round(e),this.containerSize=e,e},setClip:function(t){if(void 0!==t){var e=this.direction,i=this.$before,n=this.$beforeImage,s=this.$after,o=this.$afterImage,a=this.$handle,r="y"===e?"height":"width",h="y"===e?"top":"left";this.position=Math.max(0,Math.min(100,t)),n.css(r,this.containerSize+"px"),o.css(r,this.containerSize+"px"),i.css(r,this.position+"%"),s.css(r,100-this.position+"%"),a.css(h,this.position+"%")}}});
flexbe_cli.element.register("spoiler01",{onReady:function(){this.$list=this.$area.find(".spoiler-list"),this.$lastItem=null,this.isSpoilered=+this.$list.attr("data-spoiler"),this.bindEvents()},bindEvents:function(){var t=this;if(!this.isSpoilered)return!1;var e;this.$list.on("mousedown",".clickable",function(t){e=(!flexbe_cli.is_admin||!$(t.target).closest(".element-text, .component-image, .editor-overlay").length)&&(!$(t.target).closest(".not-clickable").length&&{target:t.currentTarget,x:t.screenX,y:t.screenY})}),this.$list.on("mouseup",".clickable",function(i){if(!(!e||e.target!==i.currentTarget||flexbe_cli.is_admin&&$(i.target).closest(".element-text").length)){Math.sqrt(Math.pow(e.x-i.screenX,2)+Math.pow(e.y-i.screenY,2))<5&&t.toggleSpoiler($(i.currentTarget)),e=!1}})},toggleSpoiler:function(t,e){var i=0;e||(e="true"!==t.attr("data-expanded"));var n=t.find(".collapsed");if(!n[0].inAnimation){n[0].inAnimation=!0;var s=t.find(".spoiler-text"),a=s.find(".spoiler-text-content"),l=n[0].scrollHeight,o=Math.max(250,Math.min(400,3*l));if(e){(i=(s.height()-a.innerHeight())/2)<10&&a.css("margin",i+"px 0")}n.off("transitionend").one("transitionend",function(){n.css("height","").toggleClass("collapsed--auto",e),n[0].inAnimation=!1}),n.css({height:l+"px",transitionDuration:o+"ms"}),e?n.addClass("collapsed--show"):(n[0].offsetHeight,n.removeClass("collapsed--show").css("height","0")),t.attr("data-expanded",e),this.$lastItem=t}}});
flexbe_cli.element.register("timer01",{sizes:{xs:33,s:40,m:55,l:80,xl:1/0},onReady:function(){this.setTimerSize()},onResize:function(){this.setTimerSize()},onScreen:function(e){e&&!this.isViewed&&(this.isViewed=!0,this.setTimerSize())},setTimerSize:function(){var e=this,i=this.$area.find(".component-timer"),t=i.outerWidth()/(i.find(".number").length+i.find(".colon").length),n=Object.keys(this.sizes).find(function(i){return e.sizes[i]>t});i.attr("data-size",n)}});
flexbe_cli.modal.register("PAY",{types:{},pay_id:"",hash:"",selectors:{},onLoad:function(){var t=this;this.start(),flexbe_cli.events.on("pay",function(a,e){e&&"init"===e.action&&t.start()})},start:function(){this.loadSelectors();var t=this.getPayStatus();if(t){switch(t){case"success":this.showSuccessAlert();break;case"fail":this.showFailAlert();break;case"pay":this.getBill()}setTimeout(function(){flexbe_cli.modal.open("pay")},300)}},loadSelectors:function(){this.selectors.$container=this.$modal.find(".modal-content"),this.selectors.$bill=this.$modal.find(".action-bill"),this.selectors.$cash=this.$modal.find(".action-cash"),this.selectors.$already=this.$modal.find(".action-already"),this.selectors.$success=this.$modal.find(".action-success"),this.selectors.$fail=this.$modal.find(".action-fail")},getPayStatus:function(){var t=!1;try{t=JSON.parse('{"'+decodeURI(location.search.substring(1)).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')}catch(t){}if(!t.pay_id)return!1;if(this.pay_id=t.pay_id,this.hash=t.h,t.pay_status){try{history.pushState(null,null,window.location.pathname)}catch(t){}return t.pay_status}return"pay"},getBillData:function(t){this.pay_id&&!1!==this.pay_id&&$.ajax({url:"/mod/pay/ajax",type:"GET",dataType:"json",data:{act:"payData",pay_id:this.pay_id,hash:this.hash}}).done(function(a){"function"==typeof t&&t(a)})},getBill:function(){var t=this;this.pay_id&&!1!==this.pay_id&&this.getBillData(function(a){if(0===a.status)return!1;t.types=a.pay.support_types,2==+a.pay.pay_status?t.showAlreadyPayed(a.pay):t.cashonly()?t.showCashInstruction(a.pay):t.showBillForm(a.pay)})},showBillForm:function(t){var a=this;this.selectors.$container.attr("data-type","bill");var e=this.selectors.$bill.find(".pay-methods-list-inner").empty(),s=this.selectors.$container.find(".pay-action"),i=this.selectors.$bill.find(".component-button"),n={cash:"cash",visa:"visa",mastercard:"mastercard",yandex:"yandex",qiwi:"qiwi",webmoney:"webmoney",webmoney_z:"webmoney",webmoney_u:"webmoney",mobile_megafon:"megafon",mobile_beeline:"bee",mobile_mts:"mts",mobile_tele2:"t2",sberbank:"sberbank",bank:"bank",w1:"w1",ibank_robo:"ibank_robo",yandex_kassa:"yandexkassa",yandexkassa:"yandexkassa",bank_company:"bank_company"};for(var o in this.types)if(this.types[o].name){var c=this.types[o],l=n[o],r='<label class="item" data-type="'+o+'" title="'+c.name+'" for="'+o+'">\n                    <input type="radio" name="form[pay_method]" value="'+o+'" id="'+o+'">\n                    <div class="item-inner">\n                            <span class="check"></span>\n\n                            <span class="icon">\n                                <img class="icon-inner" src="/_s/images/land/theme/4/res/pay/'+l+'.svg" alt="'+c.name+'" />\n                            </span>\n\n                            <span class="item-name font-size-tiny">'+c.name+"</span>\n                    </div>\n                </label>";e.append(r)}s.find(".title > span.num").text(t.pay_id),s.find(".price > span").text(t.pay_sum),e.on("click",".item",function(t){return t.preventDefault(),$(t.currentTarget).find("input").prop("checked",!0),i.removeClass("disabled"),!1}),i.on("click",function(t){var s=e.find("input:checked").val();if(!s)return e.removeClass("shake"),setTimeout(function(){e.addClass("shake")},30),!1;if("cash"===s)return a.showCashInstruction(),!1;var i="/mod/pay/?pay_type="+s+"&pay_id="+a.pay_id+"&h="+a.hash;$(t.currentTarget).attr("href",i),flexbe_cli.run.is_mobile&&flexbe_cli.run.is_OSX||$(t.currentTarget).addClass("submitting")})},showCashInstruction:function(){this.selectors.$container.attr("data-type","cash"),this.types.cash&&this.types.cash.instruction&&this.selectors.$cash.find(".text").html(this.types.cash.instruction),$.ajax({url:"/mod/pay/ajax",type:"GET",dataType:"json",data:{act:"selectCash",pay_id:this.pay_id,hash:this.hash}})},showAlreadyPayed:function(t){this.selectors.$container.attr("data-type","already");var a=this.selectors.$container.find(".pay-action"),e="";"0"!=t.pay_time_done&&(e=t.pay_time_done),this.selectors.$already.find(".text > span.num").text(t.pay_id),a.find(".title > span.num").text(t.pay_id),a.find(".sub > span").text(e),a.find(".price > span").text(t.pay_sum)},showSuccessAlert:function(){this.selectors.$container.attr("data-type","success"),flexbe_cli.stat.reach_goal("pay_done")},showFailAlert:function(){var t=this;this.selectors.$container.attr("data-type","fail"),this.getBillData(function(a){var e=t.selectors.$container.find(".pay-action");e.find(".title > span.num").text(a.pay.pay_id),e.find(".price > span").text(a.pay.pay_sum),t.selectors.$fail.find(".component-button").off("click").on("click",function(){t.getBill()})})},cashonly:function(){return this.types.cash&&1===Object.keys(this.types).length}});
function _extends(){return(_extends=Object.assign||function(t){for(var i=1;i<arguments.length;i++){var e=arguments[i];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t}).apply(this,arguments)}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}flexbe_cli.widget.register("ANCHORS",{require:["/_s/lib/anime/anime.min.js"],$list:null,onLoad:function(){var t=this;this.$list=this.$widget.find(".anchors-list"),this.list="object"==_typeof(this.$list.data("anchors"))&&this.$list.data("anchors").list||[];var i=_extends({style:1,show_title:0},this.$list.data("anchors"));this.style=i.style,this.show_title=i.show_title,this.$list.removeAttr("data-anchors"),flexbe_cli.run.is_mobile||(this.drawList(),this.setActive(),flexbe_cli.is_admin&&flexbe_cli.events.off("layout_change.anchors").on("layout_change.anchors",function(i,e){"block"===e.is&&t.drawList()}))},check:function(){var t=$(".b_block").not('[data-b-type*="overflow"]');this.list=this.list.filter(function(i){return!(!i.enabled||!t.closest('[data-id="'+i.id+'"]')[0])})},drawList:function(){var t=this;if(0===flexbe_cli.block.$blocks.length)return this.$list.hide(),!1;this.$list.show(),this.check();var i="";flexbe_cli.is_admin&&this.list.length<1?i='<svg style="color: #adadad" width="18" height="98" viewBox="0 0 18 98" xmlns="http://www.w3.org/2000/svg">\n                <g fill="none" fill-rule="evenodd">\n                    <circle opacity=".05" cx="9" cy="5" r="5"/>\n                    <circle opacity=".2" cx="9" cy="25" r="5"/>\n                    <circle opacity=".2" cx="9" cy="73" r="5"/>\n                    <circle opacity=".05" cx="9" cy="93" r="5"/>\n                    <path d="M9 40a9 9 0 1 0 0 18 9 9 0 0 0 0-18zm5.126 9.626h-4.5v4.5H8.34v-4.5h-4.5V48.34h4.5v-4.5h1.286v4.5h4.5v1.286z" opacity=".45"/>\n                </g>\n            </svg>':this.list.length>=1&&(this.list.forEach(function(e){var s=t.show_title&&e.title?' data-title="'+e.title+'"':"";i+="<li"+s+'><a href="#'+e.id+'"></a></li>'}),i+='<li class="helper"><a></a></li>'),this.$list.find("ul").html(i),this.$helper=this.$list.find(".helper"),this.animateList()},animateList:function(){var t=this;if(!(this.list.length<1)){if(flexbe_cli.is_admin)this.$helper.css({opacity:1,transform:"translateY("+24*this.index+"px)"});else{var i=anime({targets:this.$list.find("li").not(this.$helper).get(),duration:200,opacity:[0,1],scale:[.4,1],easing:"easeOutBack",autoplay:!1,delay:function(t,i){return 200*i},complete:function(){anime({targets:t.$helper.get(),duration:400,translateY:24*t.index,scale:[2.5,1],opacity:[0,1],easing:"easeInExpo"})}});this.$list.addClass("hide"),setTimeout(function(){t.$list.removeClass("hide"),i.play()},1500)}this.$list.find("li").removeClass("active").eq(this.index).addClass("active")}},index:0,setActive:function(){var t=this;if(!(this.list.length<1)){var i=function(i){t.$list.css("color",i.tween.color);var e=t.index;t.list.some(function(t,s){return+t.id==+i.id&&(e=s,!0)}),(e=Math.max(0,Math.min(t.list.length-1,e)))!==t.index&&(!function(i){if(t.$list.find("li").removeClass("active"),t.$list.find("li").eq(i).addClass("active"),1==+t.style){var e=24*i,s=i-t.index>0?12:-12;anime.remove(t.$helper[0]),anime({targets:t.$helper[0],translateY:e-s,scaleY:2.5,scaleX:.6,duration:100,easing:"easeInQuad",complete:function(){anime({targets:t.$helper[0],translateY:e,scaleY:1,scaleX:1,duration:100,easing:"easeOutQuad"})}})}}(e),t.index=e)};flexbe_cli.block.$list.find(".b_block").each(function(t,e){var s=e._core;s&&s.isFocused&&i(s)}),flexbe_cli.events.off("entity_event.anchors").on("entity_event.anchors",function(t,e){e&&e.type&&"focus"===e.type&&e.state&&e.core&&"block"===e.core.is&&i(e.core)}),this.$list.on("click","li",function(t){if(!$(t.target).is("a"))return $(t.currentTarget).find("[href]").trigger("click"),t.preventDefault(),!1})}}});
!function(){var t,e;flexbe_cli.widget.register("CART",{list:[],$list:null,$sum:null,$button:null,is_open:!1,onInit:function(){this.$container=this.$widget.find(".widget-data"),this.$list=this.$widget.find(".order-list > ul"),this.$sum=this.$widget.find(".checkout .price"),this.$button=this.$widget.find(".cart-button"),flexbe_cli.is_admin?this.list=[{id:"7832324_1",count:1,img:"/img/1000000945_200.jpg",title:"Тестовый товар 1",price:750},{id:"7832464_2",count:2,img:"/img/1000000948_200.jpg",title:"Тестовый товар 2",price:2550}]:this.loadFromStorage(),this.events(),this.popstate(),this.renderList()},onLoad:function(){this.formInit()},onUpdate:function(){this.onInit(),this.is_open&&(this.$container.addClass("fade-in noanimate"),this.open())},formInit:function(){var t=this;flexbe_cli.components.instances[this.id].forEach(function(e){"form"===e.is&&(t.form=e,e.onBeforeSend(function(){if(!t.list.length)return!1;e&&e.addItems(t.list)}),e.onAfterSent(function(){t.close(),flexbe_cli.stat.ecommerce.purchase(t.list),t.list=[],t.renderList()}))})},events:function(){var t=this;flexbe_cli.events.off("cart_command.cart-widget").on("cart_command.cart-widget",function(e,i){if(i)switch(i.command){case"toggle":t.is_open?t.close():t.open();break;case"open":t.open(i);break;case"close":t.close(i);break;case"add":t.add(i.item);break;case"remove":t.remove(i.id)}}),this.$list.off("click").on("click","[data-action]",function(e){var i=$(e.currentTarget).closest("li"),s=$(e.currentTarget).data("action"),n=i.data("id");n&&("remove"===s?t.remove(n):t.updateCount(n,s))}),this.$list.off("input").on("input",".count",function(e){var i=$(e.currentTarget).closest("li").attr("data-id"),s=+e.target.value;s||(s=1,$(e.currentTarget).val(1)),t.updateCount(i,s)}),this.$widget.off("click.cart-button").on("click.cart-button",".cart-button",function(){t.is_open?t.close():t.open()}),this.$container.off("click.close").on("click.close",'a.close, [data-overlay="true"]',function(e){e.target===e.currentTarget&&t.close()}),$(document).off("keyup.cart_esc_close").on("keyup.cart_esc_close",function(e){27===e.which&&t.close()}),$(window).on("popstate",function(){t.popstate()})},open:function(){var i=this;this.is_open=!0,this._onScreen({state:!0}),this._onView({state:!0}),this.renderList(),flexbe_cli.block.pushOverlay("cart",!0),this.oldHash=!1,flexbe_cli.is_admin?this.$container.addClass("is-editor"):(this.$button.addClass("hide"),this.loadFromStorage(),/customer_cart/.test(location.hash)||(/^#{1,2}/.test(location.hash)&&(this.oldHash=location.hash),history.pushState(null,null,"#customer_cart"))),$("body").addClass("overflow"),this.$area.addClass("show"),this.$container.hasClass("noanimate")?(this.$container.addClass("show fade-in"),this.$container.removeClass("noanimate")):(this.$container.addClass("show"),this.$container.outerHeight(),this.$container.addClass("fade-in"),this.$container.removeClass("noanimate")),flexbe_cli.run.is_screen_all_mobile?(clearTimeout(e),t=flexbe_cli.scroll.latest,e=setTimeout(function(){$("body").addClass("is-widget-open is-cart-open"),$("body, html").scrollTop(0),flexbe_cli.run.is_ios&&(i.$container.css("display","none"),i.$container.outerHeight(),i.$container.css("display",""))},350)):$("body").addClass("is-widget-open is-cart-open")},close:function(){var i=this;$(window).off("keyup.cart_esc_close"),flexbe_cli.block.removeOverlay("cart"),this.is_open&&(this.is_open=!1,$("body").removeClass("overflow"),this.$area.removeClass("show"),this.$button.removeClass("hide"),this.$container.removeClass("fade-in"),this.$container.addClass("fade-out"),/customer_cart/.test(location.hash)&&(this.oldHash?history.replaceState(null,null,this.oldHash):(flexbe_cli.lockPopstate=!0,history.replaceState(null,null,"#"),flexbe_cli.lockPopstate=!1)),setTimeout(function(){i.$container.removeClass("fade-out show noanimate")},350),flexbe_cli.run.is_screen_all_mobile?(clearTimeout(e),$("body").removeClass("is-widget-open is-cart-open"),$("body, html").scrollTop(t)):$("body").removeClass("is-widget-open is-cart-open"))},popstate:function(){var t=this;if(flexbe_cli.is_admin||flexbe_cli.lockPopstate)return!1;setTimeout(function(){/customer_cart/.test(location.hash)?t.open():t.close()},30)},add:function(t,e){if(void 0===e&&(e=!1),(!this.is_open||e)&&t){t.count=parseInt(t.count,10)||1,t.price=parseFloat(t.price)||0;var i=!1;this.list&&this.list.length&&(this.list=this.list.map(function(e){return e.id===t.id&&(e.count+=t.count,i=!0),e})),i||this.list.push(t),flexbe_cli.stat.ecommerce.add(t.id,t.title,t.count,t.price),flexbe_cli.stat.reach_goal("add_to_cart",t),this.renderList();var s=$(".cart-button");s.removeClass("blink"),setTimeout(function(){s.addClass("blink"),setTimeout(function(){s.removeClass("blink")},300)},30)}},remove:function(t){if(void 0===t&&(t=!1),!1!==t){var e=this.list.filter(function(e){return e.id==t})[0];flexbe_cli.stat.ecommerce.remove(e.id,e.title),this.list=this.list.filter(function(e){return e.id!=t}),this.renderList()}},updateCount:function(t,e){var i=this;void 0===t&&(t=!1),void 0===e&&(e="+"),!1!==t&&(this.list&&this.list.length&&(this.list=this.list.map(function(s){if(s.id==t){"+"===e?s.count+=1:"-"===e&&s.count>1?s.count-=1:(e=parseInt(e,10),s.count=e||1),s.count=parseInt(s.count,10)||1;var n=i.$list.find('[data-id="'+t+'"]');n.find(".price").text(i.formatPrice(s.count*s.price)),"-"!==e&&"+"!==e||n.find(".count").val(s.count),flexbe_cli.stat.ecommerce.add(s.id,s.title,s.count,s.price)}return s})),this.saveToStorage(),this.renderCount())},renderList:function(){var t=this;this.saveToStorage(),this.renderCount();var e="";this.list.length?(this.list.forEach(function(i){e+=function(e){return'\n                <li data-id="'+e.id+'">\n                    <div class="img-holder">\n                        <div class="img" '+(e.img?'style="background-image: url('+e.img+')"':"")+'></div>\n                    </div>\n\n                    <div class="content-holder">\n                        <div class="flex-line item-title-outer">\n\n                        <div class="item-title">'+(e.title||"-")+'</div>\n                            <a class="close-times" data-action="remove"></a>\n                        </div>\n\n                        <div class="flex-line item-count-outer">\n                            <div class="item-count">\n                                <a data-action="-"></a>\n                                <input type="number" class="count" min="1" value="'+e.count+'"/>\n                                <a data-action="+"></a>\n                            </div>\n\n                            <div class="item-price text-style-strong">\n                                <span class="price">'+t.formatPrice(e.price*e.count)+'</span>\n                                <span class="curr">'+flexbe_cli.lang.currency+"</span>\n                            </div>\n                        </div>\n                    </div>\n                </li>"}(i)}),this.$container.removeClass("cart-is-empty")):this.$container.addClass("cart-is-empty"),this.$list.html(e),this.form&&this.form.addItems(this.list),flexbe_cli.events.emit("cart_event",{event:"updateList",sender:"core",list:this.list})},renderCount:function(){var t=0,e=0;this.list.length&&this.list.forEach(function(i){i.count&&(t+=parseInt(i.count,10),i.price&&(e+=parseInt(i.count,10)*parseFloat(i.price)))}),this.count=t,this.sum=e,this.$sum.text(this.formatPrice(e)),this.$container.find(".product-count .count").text(t),$(".cart-button").attr("data-count",t),flexbe_cli.events.emit("cart_event",{event:"updateCount",sender:"core",count:t,sum:e})},formatPrice:function(t){return t=String(t).replace(",",".").replace(/[^0-9.]/g,""),t=t.split("."),t[0]=chunkSplit(t[0]),t[1]&&(t[1]=t[1].length<2?t[1]+="0":t[1].substr(0,2)),t.length>2&&(t=t.splice(0,2)),t.join(".")},loadFromStorage:function(){if(!flexbe_cli.is_admin&&localStorage)try{var t=JSON.parse(localStorage.getItem("f_cart"));t&&t instanceof Array&&(this.list=t)}catch(t){}},saveToStorage:function(){if(!flexbe_cli.is_admin&&localStorage)if(this.list&&this.list instanceof Array)try{localStorage.setItem("f_cart",JSON.stringify(this.list))}catch(t){}else this.list=[]}})}();
!function(){var e,t,n={hidden:"hidden-all-m",navCreated:"mobile-navigation--created",cartContainer:"nav-header-controls--cart",burgerContainer:"nav-header-controls--burger"},a={block:".b_block",element:".element-item",nav:".mobile-navigation",header:".header-wrapper",cartBtn:".widget-list .cart-button",navbar:".nav-header",navbarContent:".nav-header-content",navbarControls:".nav-header-controls",navmenu:".nav-menu",navmenuItem:".nav-menu-item"},r=function(e,t){void 0===t&&(t=!1);var r=$(e);if(!r.is(a.element)){var i=r.closest(a.element);r=i.length?i:r}r.toggleClass(n.hidden,!t)};flexbe_cli.widget.register("MENU01",{created:{},onLoad:function(){this.createWidget()},createWidget:function(){var e=this;this.clickEvent="click",this.navbarStyle=!1,this.navmenuCreated=!1;var t=$(a.block).slice(0,3).find(a.header).eq(0);if((t=t.filter(function(e,t){var n=$(t).offset();return n&&n.top<=800})).length){var r=t.attr("data-fixed-color")||"light",i=t.attr("data-fixed-contrast")||"dark";this.cssBackground=r,this.background=r,this.contrast=i,["light","dark"].includes(r)&&(this.cssBackground="light"===r?"#FFF":"#000")}this.$source=t,this.$nav=this.$area.find(a.nav),this.$navbar=this.$area.find(a.navbar),this.$navmenu=this.$area.find(a.navmenu),this.fillNavmenu(),this.fillNavbar(),this.navbarStyle&&((this.background||this.cssBackground)&&(["light","dark"].includes(this.background)?this.$nav.attr("data-color",this.background):this.cssBackground&&(this.$navbar.css("background-color",this.cssBackground),this.$navmenu.css("background-color",this.cssBackground))),this.contrast?this.$nav.attr("data-contrast",this.contrast):this.color&&this.$nav.css("color",this.color),setTimeout(function(){if(e.$nav.addClass(n.navCreated+" header-style-"+e.navbarStyle),"panel"===e.navbarStyle){var t=e.$navbar.outerHeight();(e.$source.find(".elements-list").outerHeight()||0)<40&&e.$source.closest(".header-area, .b_block").addClass(n.hidden),flexbe_cli.block.$list.eq(0).css("paddingTop",t+"px")}},30)),this.navmenuCreated&&flexbe_cli.events.off("mobilemenu_command").on("mobilemenu_command",function(t,n){if(n)switch(n.command){case"toggle":e.toggleMenu();break;case"open":e.openMenu();break;case"close":e.closeMenu()}})},fillNavbar:function(){var e=this,t=e.created,i=e.$navbar,s=e.$source,o=e.navmenuCreated,c=i.find(a.navbarContent),l=i.find(a.navbarControls);c.empty(),l.empty();var d=[],u=[];return function(){var i=$(a.cartBtn).eq(0);if(i.length){t.cart=!0,u.push("cart"),e.$cart=$('<li class="'+n.cartContainer+'"></li>'),e.$cart.append(i.clone()),r(i,!1),l.append(e.$cart),e.background||(e.color=i.css("color"),e.cssBackground=i.css("background-color"),e.background=this.cssBackground);var s=i.closest(".w_widget"),o=s[0]&&s[0]._core;e.$cart.on(e.clickEvent,function(){e.toggleMenu(!1),flexbe_cli.events.emit("cart_command",{command:"toggle"})}),flexbe_cli.events.on("cart_event.mobilemenu",function(e,t){t&&"updateCount"===t.event&&o&&l.toggleClass("cart-empty",!o.count)}),o&&l.toggleClass("cart-empty",!o.count)}else t.cart=!1;t.cart}(),o?(e.$burger=$('<li class="'+n.burgerContainer+'"><i></i><i></i><i></i></li>'),l.append(e.$burger),u.push("burger"),e.$burger.on(e.clickEvent,function(){e.toggleMenu()}),t.burger=!0):t.burger=!1,t.burger,u.length&&function(){var e=s.find(".component-logo").eq(0);if(e.length){var n=40/Math.max(.35,e.innerHeight()/e.innerWidth()),a=e.clone();t.logo=!0,a.css({fontSize:"",maxWidth:n+"px"}),c.append(a),d.push("logo"),r(e,!1)}else t.logo=!1;t.logo}(),d.length&&u.length||u.length>1?this.navbarStyle="panel":0===d.length&&1===u.length?this.navbarStyle="round":this.navbarStyle=!1,{contentCreated:d,controlsCreated:u,style:this.navbarStyle}},fillNavmenu:function(){var e=this.created,t=this.$source;return this.$navmenu.find(a.navmenuItem).each(function(a,r){var i=$(r),s=i.attr("data-element"),o=t.find('[data-e-id="'+s+'"]'),c=o.length;c&&(i.append(o.clone()),i.find('[data-direction="row"]').attr("data-direction","column"),i.find(".element-content").removeClass("justify-content-center justify-content-end").addClass("justify-content-start"),o.addClass(n.hidden),e[s]=e[s]?e[s]+c:c)}),this.navmenuCreated=Object.keys(e).length,this.navmenuCreated},toggleMenu:function(e){this[(e=void 0===e?!(e=[!0,"true"].includes(this.$nav.attr("data-opened"))):!!e)?"openMenu":"closeMenu"]()},openMenu:function(){var n=this;this.$area.addClass("show");var a=this.$nav.outerHeight();this.$area.css("minHeight",a+"px"),this.$nav.attr("data-opened",!0),this.$navmenu.addClass("active"),this.$burger&&this.$burger.addClass("active"),$("body").addClass("overflow"),flexbe_cli.block.pushOverlay("mobilemenu"),flexbe_cli.run.is_screen_all_mobile&&(clearTimeout(e),t=flexbe_cli.scroll.latest,e=setTimeout(function(){$("body").addClass("is-widget-open is-mobilemenu-open").css("background",n.cssBackground),$("body, html").scrollTop(0)},1e3))},closeMenu:function(){flexbe_cli.run.is_screen_all_mobile&&(clearTimeout(e),$("body").removeClass("is-widget-open is-mobilemenu-open").css("background",""),$("body, html").scrollTop(t)),this.$area.removeClass("show"),this.$area.css("minHeight",""),this.$nav.attr("data-opened",!1),this.$navmenu.removeClass("active"),this.$burger&&this.$burger.removeClass("active"),$("body").removeClass("overflow"),flexbe_cli.block.removeOverlay("mobilemenu")}})}();